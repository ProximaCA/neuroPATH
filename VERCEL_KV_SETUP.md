# Настройка Vercel KV для neuroPATH

## 1. Создание Vercel KV хранилища

1. Зайдите в [Vercel Dashboard](https://vercel.com/dashboard)
2. Перейдите в раздел "Storage"
3. Нажмите "Create Database" → "KV"
4. Выберите имя (например, `neuropath-kv`)
5. Выберите регион (ближайший к вашим пользователям)
6. Нажмите "Create"

## 2. Подключение к проекту

1. После создания KV, нажмите "Connect Project"
2. Выберите ваш проект neuroPATH
3. Vercel автоматически добавит переменные окружения:
   - `KV_URL`
   - `KV_REST_API_URL`
   - `KV_REST_API_TOKEN`
   - `KV_REST_API_READ_ONLY_TOKEN`

## 3. Локальная разработка

Для локальной разработки создайте файл `.env.local` в папке `nextjs-starter`:

```env
KV_URL="redis://..."
KV_REST_API_URL="https://..."
KV_REST_API_TOKEN="..."
KV_REST_API_READ_ONLY_TOKEN="..."
```

Значения можно взять из Vercel Dashboard → Storage → ваша KV → .env.local tab

## 4. Деплой

1. Сделайте коммит изменений:
```bash
git add .
git commit -m "feat: migrate from Supabase to Vercel KV"
git push
```

2. Vercel автоматически задеплоит проект с новыми настройками

## 5. Проверка

После деплоя проверьте:
- Создание пользователя при первом входе
- Сохранение прогресса миссий
- Начисление минут и света
- Работу реферальной системы
- Отображение друзей

## Лимиты бесплатного плана

- 30MB хранилища
- 3000 запросов в день
- 150 команд в секунду

Для neuroPATH этого достаточно для ~100 активных пользователей в день.

## Troubleshooting

### Ошибка подключения
- Проверьте, что переменные окружения правильно настроены
- Убедитесь, что KV создан в том же аккаунте Vercel

### Данные не сохраняются
- Проверьте логи в Vercel Dashboard → Functions
- Убедитесь, что используете правильные ключи для данных

### Превышен лимит запросов
- Оптимизируйте количество запросов (группируйте операции)
- Рассмотрите апгрейд на Pro план ($20/месяц) 